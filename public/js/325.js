"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[325],{2325:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){o(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const s={name:"MyOrders",data:function(){return{orders:[],dialog:!1,lead:{},delivered:"0",comment:"",amount:null,payment_type:"Без оплаты",types:[]}},created:function(){this.fetchOrders()},computed:a(a({},(0,n(629).Se)({user:"auth/user"})),{},{isActive:function(){var t=(new Date).getHours();return 2===this.user.city_id?t>=5&&t<=11:t>=5&&t<=10}}),methods:{fetchOrders:function(){var t=this;axios.get("/api/my-orders").then((function(e){e.data.status&&(t.orders=e.data.data,t.types=e.data.payment_types)})).catch((function(t){console.log(t)}))},notify:function(t){var e=this;axios.post("/api/my-orders/notify",{order_id:t}).then((function(t){e.$store.dispatch("showAlert",{isVisible:!0,msg:t.data.msg,color:t.status?"green":"error",type:t.status?"success":"error"}),e.fetchOrders()})).catch((function(t){console.log(t)}))},openDialog:function(t){this.lead=t,this.dialog=!0},report:function(){var t=this;axios.post("/api/my-orders/report",{status:this.delivered,order_id:this.lead.id,comment:this.comment,amount:this.amount,payment_type:this.payment_type}).then((function(e){t.delivered="0",t.comment="",t.amount=null,t.payment_type="Без оплаты",t.dialog=!1,t.$store.dispatch("showAlert",{isVisible:!0,msg:e.data.msg,color:e.status?"green":"error",type:e.status?"success":"error"}),t.fetchOrders()})).catch((function(t){console.log(t)}))},closeDialog:function(){this.dialog=!1,this.delivered="0",this.comment="",this.amount=null,this.payment_type="Без оплаты"}}};const i=(0,n(1900).Z)(s,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-row",[t._l(t.orders,(function(e,r){return n("v-col",{key:e.id,attrs:{cols:"12",sm:"4"}},[n("v-card",[n("div",{staticClass:"d-flex align-start justify-space-between"},[n("div",[n("v-card-title",[t._v(t._s(e.name))]),t._v(" "),n("v-card-subtitle",[n("v-chip",{attrs:{label:"",color:e.color,small:""}},[t._v("\n                            "+t._s(e.tag)+"\n                        ")]),t._v(" "),n("v-chip",{attrs:{label:"",color:e.color,small:""}},[t._v("\n                            "+t._s(e.time)+"\n                        ")])],1)],1),t._v(" "),n("div",[n("v-card-title",[t._v(t._s(r+1))])],1)]),t._v(" "),e.pay_comment?n("div",[n("v-card-text",{staticClass:"font-weight-bold"},[t._v("\n                    "+t._s(e.pay_comment)+"\n                ")]),t._v(" "),n("v-divider",{staticClass:"my-3"})],1):t._e(),t._v(" "),n("v-card-text",[t._v("\n                "+t._s(e.logistic)+"\n            ")]),t._v(" "),n("v-divider"),t._v(" "),n("v-card-text",[n("strong",[t._v(t._s(e.address))])]),t._v(" "),n("v-card-actions",[n("v-btn",{attrs:{href:"tel:"+e.phone,small:""}},[t._v("\n                    Тел\n                ")]),t._v(" "),n("v-btn",{attrs:{href:"https://api.whatsapp.com/send?phone="+e.whatsapp+"&text="+encodeURIComponent("Здравствуйте! Это, EAT&FIT "),small:"",target:"_blank"}},[t._v("\n                    Ватсап\n                ")]),t._v(" "),n("v-btn",{attrs:{href:"yandexmaps://maps.yandex.ru/?rtext=~"+e.lat+","+e.lng,small:""}},[t._v("\n                    Yndx\n                ")]),t._v(" "),n("v-btn",{attrs:{href:"dgis://2gis.ru/routeSearch/rsType/car/to/"+e.lng+","+e.lat,small:""}},[t._v("\n                    2GIS\n                ")])],1),t._v(" "),n("v-card-actions",[t.isActive?n("v-btn",{staticClass:"white--text",attrs:{color:"blue-grey",small:"",disabled:e.is_notified},on:{click:function(n){return t.notify(e.id)}}},[t._v("\n                    Еду\n                    "),e.is_notified?n("v-icon",{attrs:{right:""}},[t._v("\n                        mdi-check\n                    ")]):t._e()],1):t._e(),t._v(" "),n("v-btn",{staticClass:"white--text",attrs:{color:"blue-grey",small:""},on:{click:function(n){return n.stopPropagation(),t.openDialog(e)}}},[t._v("\n                    Отчет\n                    "),e.is_reported?n("v-icon",{attrs:{right:""}},[t._v("\n                        mdi-check\n                    ")]):t._e()],1)],1)],1)],1)})),t._v(" "),n("v-dialog",{attrs:{transition:"dialog-bottom-transition","max-width":"600"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[n("v-card",[n("v-toolbar",{attrs:{color:"primary",dark:""}},[t._v("\n                Отчет "+t._s(t.lead.name)+"\n                "),n("v-spacer"),t._v(" "),n("v-toolbar-items",[n("v-btn",{attrs:{icon:"",dark:""},on:{click:function(e){t.dialog=!1}}},[n("v-icon",[t._v("mdi-close")])],1)],1)],1),t._v(" "),n("v-card-text",[n("v-radio-group",{attrs:{row:""},model:{value:t.delivered,callback:function(e){t.delivered=e},expression:"delivered"}},[n("v-radio",{staticClass:"mb-1",attrs:{label:"Доставлено",value:"0"}}),t._v(" "),n("v-radio",{attrs:{label:"Не доставлено",value:"1"}})],1),t._v(" "),n("v-textarea",{attrs:{outlined:"",label:"Комментарий"},model:{value:t.comment,callback:function(e){t.comment=e},expression:"comment"}}),t._v(" "),"0"===t.delivered?n("v-radio-group",{attrs:{row:""},model:{value:t.payment_type,callback:function(e){t.payment_type=e},expression:"payment_type"}},t._l(t.types,(function(t){return n("v-radio",{key:t.name,staticClass:"mb-2",attrs:{label:t.name,value:t.name}})})),1):t._e(),t._v(" "),"Без оплаты"!==t.payment_type?n("v-text-field",{attrs:{label:"Сумма",type:"number",outlined:""},model:{value:t.amount,callback:function(e){t.amount=e},expression:"amount"}}):t._e()],1),t._v(" "),n("v-card-actions",[n("v-spacer"),t._v(" "),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:t.closeDialog}},[t._v("\n                    Закрыть\n                ")]),t._v(" "),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:t.report}},[t._v("\n                    Отправить\n                ")])],1)],1)],1)],2)}),[],!1,null,null,null).exports}}]);