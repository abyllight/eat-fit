"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[103],{7103:(e,s,r)=>{r.r(s),r.d(s,{default:()=>u});var t=r(7757),n=r.n(t);function o(e,s,r,t,n,o,a){try{var u=e[o](a),i=u.value}catch(e){return void r(e)}u.done?s(i):Promise.resolve(i).then(t,n)}const a={name:"EditUser",data:function(){return{user:{},items:[],errors:[]}},beforeMount:function(){this.fetchUser()},mounted:function(){this.fetchRoles()},methods:{fetchUser:function(){var e=this,s=this.$route.params.id;axios.get("/api/users/"+s+"/edit").then((function(s){s.data.status||e.$store.dispatch("showAlert",{isVisible:!0,msg:s.data.msg,color:s.data.status?"green":"error",type:s.data.status?"success":"error"}),e.user=s.data.user})).catch((function(e){console.log(e)}))},fetchRoles:function(){var e,s=this;return(e=n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,axios.get("/api/roles").then((function(e){var r;s.items=null!==(r=e.data)&&void 0!==r?r:[]})).catch((function(e){console.log(e)}));case 2:case"end":return e.stop()}}),e)})),function(){var s=this,r=arguments;return new Promise((function(t,n){var a=e.apply(s,r);function u(e){o(a,t,n,u,i,"next",e)}function i(e){o(a,t,n,u,i,"throw",e)}u(void 0)}))})()},update:function(){var e=this,s=this.getPhone(this.user.phone);axios.patch("/api/users/"+this.user.id,{name:this.user.name,phone:s,roles:this.user.roles,password:this.user.password}).then((function(s){e.$store.dispatch("showAlert",{isVisible:!0,msg:s.data.msg,color:s.data.status?"green":"error",type:s.data.status?"success":"error"}),e.$router.push("/users")})).catch((function(s){e.errors=s.response.data.errors}))},getPhone:function(e){return e.replace(/[^0-9]/g,"")}}};const u=(0,r(1900).Z)(a,(function(){var e=this,s=e.$createElement,r=e._self._c||s;return r("v-row",{attrs:{align:"center",justify:"center"}},[r("v-col",{attrs:{cols:"12",sm:"10",md:"8",lg:"6"}},[r("v-card",[r("v-card-title",[e._v("\n                Редактировать пользователя\n            ")]),e._v(" "),r("v-card-text",[r("v-text-field",{attrs:{"error-messages":e.errors.name,label:"Имя",outlined:"",required:""},model:{value:e.user.name,callback:function(s){e.$set(e.user,"name",s)},expression:"user.name"}}),e._v(" "),r("v-text-field",{directives:[{name:"mask",rawName:"v-mask",value:"+7 (###) ###-##-##",expression:"'+7 (###) ###-##-##'"}],attrs:{"error-messages":e.errors.phone,outlined:"",label:"Телефон",required:""},model:{value:e.user.phone,callback:function(s){e.$set(e.user,"phone",s)},expression:"user.phone"}}),e._v(" "),r("v-select",{attrs:{items:e.items,"item-text":"name","item-value":"id","error-messages":e.errors.roles,outlined:"",chips:"",label:"Роли",multiple:""},model:{value:e.user.roles,callback:function(s){e.$set(e.user,"roles",s)},expression:"user.roles"}}),e._v(" "),r("v-text-field",{attrs:{"error-messages":e.errors.password,label:"Пароль",outlined:"",required:""},model:{value:e.user.password,callback:function(s){e.$set(e.user,"password",s)},expression:"user.password"}}),e._v(" "),r("v-btn",{attrs:{color:"primary",type:"submit"},on:{click:e.update}},[e._v("\n                    Обновить\n                ")])],1)],1)],1)],1)}),[],!1,null,null,null).exports}}]);